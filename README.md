# Отчёт по итерации «Разработка первичной модели»

## Введение

Данная итерация представляет собой первый этап проекта по распознаванию бухгалтерских документов фиксированной формы (УПД, ТОРГ-12, Счёт-фактура) с использованием технологий Optical Character Recognition (OCR).
Целью итерации являлась разработка первичной рабочей модели распознавания документов, проведение сравнительного анализа существующих архитектур и создание базовой инфраструктуры для дальнейшего развития проекта.

## Ход работы

### 1. Формирование датасета

Для обучения и тестирования моделей был получен доступ к системе 1С, из которой выгружены документы трёх типов: **универсальный передаточный документ (УПД)**, **ТОРГ-12** и **счёт-фактура**.
Документы были очищены, нормализованы и приведены к единому формату изображений, пригодному для OCR-распознавания.
На основе полученных данных сформирован базовый датасет, который использовался на всех этапах экспериментов.

### 2. Анализ существующих решений и подбор моделей

В рамках анализа протестированы несколько архитектур OCR-систем:

* **PaddleOCR** — продемонстрировала стабильную работу с кириллическим текстом после адаптации. Показала хорошее качество распознавания на документах смешанного типа (текстовые и табличные области).
* **MinerU** — протестирована ограниченно; функциональность показалась перспективной, однако система недостаточно гибка для интеграции и тонкой настройки.
* **Avision** — не использовалась из-за отсутствия открытого исходного кода и невозможности корректной локальной интеграции.

По результатам сравнительного анализа была выбрана **PaddleOCR** как основная модель для дальнейших экспериментов и дообучения.
Дополнительно в планах предусмотрено тестирование модели **Chandra** на следующих итерациях.

### 3. Разработка базовой инфраструктуры

С нуля был создан прототип пайплайна обработки документов, включающий:

* модуль загрузки и предобработки изображений;
* интерфейс для выбора и тестирования различных OCR-моделей;
* подсистему логирования и хранения результатов распознавания;
* модуль валидации корректности распознанного текста.

Пайплайн спроектирован с возможностью дальнейшего масштабирования и интеграции дополнительных моделей и классификаторов.

#### Блок-схема пайплайна:

**flowchart TD**
    A[Вход: скан/фото] --> B[Предобработка (дескей, бинаризация, ориентация)]
    B --> C[Детекция текстовых областей(DB/PP-OCRv3-det)]
    C --> D[Рекогнайзер текста(SVTR/CRNN, fine-tuned кириллица)]
    D --> E[Анализ структуры страницы (блоки/таблицы/ячейки)]
    E --> F[Извлечение ключевой информации (KIE)]
    F --> G{Печать/подписи?}
    G -- да --> H[Детектор печатей/подписей]
    G -- нет --> I[Пропустить]
    H --> J[Пост-обработка]
    I --> J[Пост-обработка]
    J --> K[Лёгкая LLM-посткоррекция (ошибки распознавания)]
    K --> L[Валидация реквизитов и форматов]
    L --> M[Экспорт: JSON / CSV]

### 4. Дообучение PaddleOCR

На основе подготовленного кириллического датасета была выполнена адаптация (fine-tuning) PaddleOCR для повышения качества распознавания русскоязычных текстов.
Основная цель дообучения — сократить количество ошибок подмены кириллических символов на латиницу и улучшить общее качество распознавания длинных текстовых фрагментов.

### 5. Сравнение моделей

Тестирование проводилось на ранее невиданных документах.
Ключевые результаты:

* После дообучения модель выдавала **на 15–20 % больше корректно распознанных токенов**.
* **Character Error Rate (CER)** снизился с ≈ 0.35 до ≈ 0.28, то есть количество посимвольных ошибок уменьшилось примерно на **20 %**.
* Ошибки подмены кириллических букв на латиницу (н → H, г → r, в → B) стали встречаться значительно реже.
* Геометрия текстовых блоков оставалась идентичной, что говорит о стабильности детектора и улучшении именно на уровне рекогнайзера.
* Ошибки в числовых строках и таблицах сохраняются на прежнем уровне, что подтверждает необходимость дальнейшей оптимизации языковой модели.

## Результаты

1. Сформирован собственный датасет из выгрузок 1С.
2. Разработан и протестирован базовый пайплайн OCR-обработки документов.
3. Проведён сравнительный анализ нескольких архитектур; выбрана PaddleOCR.
4. Реализован fine-tuning PaddleOCR на кириллическом датасете.
5. Зафиксировано улучшение качества распознавания по ключевым метрикам (CER ↓ на ~20 %).

## Заключение

Первая итерация «Разработка первичной модели» позволила построить работающий прототип системы OCR, адаптированной под русскоязычные бухгалтерские документы.
Полученные результаты подтверждают целесообразность выбранного подхода и создают основу для последующих этапов — классификации типов документов, извлечения реквизитов и интеграции OCR-модуля в комплексную систему документооборота.

---

# Распределение по задачам на первой итерации

**От лица тимлида (по данным доски Canvas):**

1. **Анкудинов Олег Андреевич**

   * Разработка инфраструктуры проекта
   * Генерация тестовых файлов Счёт-фактур
   * Генерация тестовых файлов УПД

2. **Архипов Роман Павлович**

   * Анализ технологий OCR и подбор решений
   * Генерация файлов УПД и ТОРГ-12
   * Тестирование PaddleOCR

3. **Беззубин Сергей Алексеевич**

   * Исследование архитектур OCR-моделей
   * Анализ проблем и возможных улучшений
   * Тестирование PaddleOCR

4. **Зайченко Иван Андреевич**

   * Анализ OCR-моделей
   * Разбор ошибок и формирование отчётности
   * Тестирование PaddleOCR

5. **Кобелев Данила Александрович**

   * Тестирование модели Chandra
   * Генерация файлов Счёт-фактур
   * Поиск и анализ embedding- и reranker-моделей

6. **Соболев Александр Андреевич**

   * Разработка пайплайна и интеграция компонентов
   * Поиск embedding- и reranker-моделей для последующих итераций